pico-8 cartridge // http://www.pico-8.com
version 42
__lua__
--goals:
--constellation game
--connect the stars using direction
--keys, time constrained
--thats all ive got

--dark blue
pal(0,129,1)

function _init()
	score=0
 stars={}
 star_types={star,
 	far_star,
 	near_star
	}
 
 for i=1,50 do
  local star_type = rnd(star_types)
  
  add(stars,star_type:new{
   x=rnd(127),
   y=rnd(127)
  })
 end
 istarpoint()
 iplayer()
 
 
end

function _update()
 for star in all(stars) do
  star:update()
 end
 
 ustarpoint()
 uplayer()
 
end

function _draw()
 cls()
 for star in all(stars) do
  star:draw()
 end
 map()

 print("score: "..score,8,8,7)
 
 dplayer()
 
end

-->8
-- class

global=_ENV

class=setmetatable({
	new=function(self,tbl)
  tbl=tbl or {}
  setmetatable(tbl,{
   __index=self
  })
  return tbl
 end,
},{__index=_ENV})

entity=class:new({
	x=0,
	y=0,
})
-->8
-- stars

star=entity:new({
 spd=0.5,
 rad=0,
 clr=13,
 
 
 update=function(_ENV)
  y+=spd
  
  if y-rad > 127 then
   y=-rad
  end
 end,
 
 draw=function(_ENV)
  circfill(x,y,rad,clr)
 end
})

far_star=star:new({
 clr=1,
 spd=0.25,
 rad=0
})

near_star=star:new({
 clr=7,
 spd=0.75,
 rad=1,
 
 new=function(self,tbl)
  tbl=star.new(self,tbl)
  
  tbl.spd=tbl.spd+rnd(0.5)
  
  return tbl
 end
})
-->8
--player

function iplayer()
 player = {
  sp=2,
  x=63,
 	y=63,
 	w=2,
 	h=2,
 	flpx=false,
 	flpy=false,
 	dx=0,
 	dy=0,
 	max_dx=3,
 	max_dy=3,
 	acc=0.5	
 	}
 	
 friction = 0.95
 --add speed so it can drift
end

function uplayer()
	--physics
	player.dy*=friction
	player.dx*=friction
	move()
end

function dplayer()
 spr(2,player.x,player.y,2,2,player.flpx,player.flpy)
end

--collision
function move() --move an object
 
 if btn(➡️) and btn(⬆️) then 
  player.dx += player.acc/sqrt(2)
  player.dy -= player.acc/sqrt(2)
  player.flpx = false
  player.flpy = false
 elseif btn(➡️) and btn(⬇️) then 
  player.dx += player.acc/sqrt(2)
  player.dy += player.acc/sqrt(2)
  player.flpx = false
  player.flpy = true
 elseif btn(⬅️) and btn(⬆️) then
  player.dx -= player.acc/sqrt(2)
  player.dy -= player.acc/sqrt(2)
  player.flpx = true
  player.flpy = true
 elseif btn(⬅️) and btn(⬇️) then
  player.dx -= player.acc/sqrt(2)
  player.dy += player.acc/sqrt(2)
  player.flpx = true
  player.flpy = true
 elseif btn(➡️) then 
  player.dx += player.acc
  player.flpx = false
 elseif btn(⬅️) then
  player.dx -= player.acc
  player.flpx = true
 elseif btn(⬆️) then
  player.dy -= player.acc
  player.flpy = false
 elseif btn(⬇️) then
  player.dy += player.acc
  player.flpy = true
 end
 --move player
 player.x += player.dx
 player.y += player.dy

	--check collision!! 
	if player.x>120 and player.dx>0 
	or player.x<-7 and player.dx<0 then
	 player.dx*=-1
	end
	if player.y>120 and player.dy>0
	or player.y<-7 and player.dy<0 then
	 player.dy*=-1
	end
end
-->8
-- stars for points

function istarpoint()
 starpoint = {
  x=30,
  y=30}
end

function ustarpoint()
 if fget(flr(player.x/8),flr(player.y/8))==0 then
  score +=1 
 end
end

function dstarpoint()
 
end
__gfx__
00000000000600000000000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001710000000000000015100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0070070001676100000000001111f510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00077000677777600000111155777710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
000770000167610000116775ff717771000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00700700006760000167777666777771000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000001710001677777776777751000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000600001777777777667771000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000001777777777776110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000001777777777776100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000001677777776665510000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000166777666511571000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000015666611510110000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000015115101710000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000017117100100000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000001001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__gff__
0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__map__
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000001000001000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000010000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
